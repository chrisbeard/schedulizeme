<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Schedulize Me</title>
	<meta name="description" content="Schedulize Me - an interactive class scheduler for students.">
	<meta name="author" content="">

	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="bootstrap/css/bootstrap-theme.min.css">
	<script src="bootstrap/js/bootstrap.min.js"></script>

	<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
</head>

<body>

	<header class="header clearfix">
		<h1 class="title">Schedulize Me</h1>
	</header>
	<section class="sidebar">

		<div class="spacer"></div>

			<h4>Build your schedule.</h4>
			<!-- <div class="dropdown course-department" id="selectDept">
				<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
					Select Department
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1" id>
					<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
					<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
					<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
				</ul>
			</div> -->

			<div class="styled-select">
				<select id="selectDept" class="course-nav">
				</select>
			</div>
			<div class="styled-select">
				<select id="selectCourse" class="course-nav" selected="Course">
				</select>
			</div>
			<div class="styled-select">
				<select id="selectSection" class="course-nav">
				</select>
			</div>
			<a href="#" class="btn btn-info" id="addSection"><i class="icon-white icon-plus"></i>Add</a>
	</section>

	<div class="calendar">
		<div class="side-spacer"></div>
			<!-- <iframe src="https://www.google.com/calendar/embed?height=600&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=cbeard1%40binghamton.edu&amp;color=%23853104&amp;ctz=America%2FNew_York" style=" border-width:0 " width="800" height="600" frameborder="0" scrolling="no"></iframe> -->
			<iframe id="cal" src="https://www.google.com/calendar/embed?showTitle=0&amp;src=cbeard1%40binghamton.edu&amp;showNav=0&amp;showDate=0&amp;showPrint=0&amp;showTabs=0&amp;showCalendars=0&amp;showTz=0&amp;mode=WEEK&amp;height=550&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;ctz=America%2FNew_York" style=" border-width:0 " width="1100" height="550" frameborder="0" scrolling="no"></iframe>
	</div>


	<!-- Populate department list -->  
	<script type="text/javascript">
		$.get('http://trump6.com/schedulizeme/api/dept.php', function(data) {
			$('#selectCourse').empty();
			$('#selectSection').empty();
			var depts = JSON.parse(data);
			var select = document.getElementById("selectDept");
			var firstElement = document.createElement("option");
			firstElement.textContent = "Choose Department";
			firstElement.value = "";
			$(firstElement).attr('selected', 'selected');
			$(firstElement).attr('disabled', 'disabled');
			select.appendChild(firstElement);
			for(var i = 0; i < depts.length; i++) {
				var opt = depts[i];
				var el = document.createElement("option");
				// console.log(opt["dept"]);
				el.textContent = opt["dept"];
				el.value = opt["dept"];
				select.appendChild(el);
			}
		});
	</script>

	<!-- Populate course list -->
	<script type="text/javascript">
		$(selectDept).on('change', function() {
			$('#selectCourse').css('visibility', 'visible');
			$('#selectSection').css('visibility', 'hidden');
			$('#addSection').css('visibility', 'hidden');
			$('#selectCourse').empty();
			$('#selectSection').empty();
			var dept = $('#selectDept').val();
			$.get('http://trump6.com/schedulizeme/api/courses.php?dept=' + dept, function(data) {
				var courses = JSON.parse(data);
				var select = document.getElementById("selectCourse");
				var firstElement = document.createElement("option");
				firstElement.textContent = "Choose Course";
				firstElement.value = "";
				$(firstElement).attr('selected', 'selected');
				$(firstElement).attr('disabled', 'disabled');
				select.appendChild(firstElement);
				for(var i = 0; i < courses.length; i++) {
					var opt = courses[i];
					var el = document.createElement("option");
					el.textContent = opt["num"] + ' - ' + opt["title"];
					el.value = opt["num"];
					select.appendChild(el);
				}
			});
		});
	</script>
	
	<!-- Populate section list -->
	<script type="text/javascript">
		$(selectCourse).on('change', function() {
			$('#selectSection').css('visibility', 'visible');
			$('#addSection').css('visibility', 'visible');
			$('#selectSection').empty();
			var dept = $('#selectDept').val();
			var course = $('#selectCourse').val();
			var extension = dept + '&courseNum=' + course;
			$.get('http://trump6.com/schedulizeme/api/sections.php?dept=' + extension, function(data) {
				var sections = JSON.parse(data);
				var select = document.getElementById("selectSection");
				var firstElement = document.createElement("option");
				firstElement.textContent = "Choose Section";
				firstElement.value = "";
				$(firstElement).attr('selected', 'selected');
				$(firstElement).attr('disabled', 'disabled');
				select.appendChild(firstElement);
				for(var i = 0; i < sections.length; i++) {

					// Check number of sections that are 0 credits
					// Check first letter against labs

					var opt = sections[i];
					var el = document.createElement("option");
					el.textContent = opt["days"] + ': ' + opt["beginTime"] + ' - ' + opt["endTime"];
					el.value = opt["crn"];
					select.appendChild(el);
				}
			});
		});
	</script>

	<!-- Send crn to php to add course to google calendar -->
	<script type="text/javascript">
		$(addSection).click(function() {
			console.log("Button clidked");
			var crn = $('#selectSection').val();
			$.get('http://trump6.com/schedulizeme/api/addEvent.php?crn=' + crn);
			console.log("waiting...");
			// $.delay(500)
			var iframe = document.getElementById("#cal");
			$.delay(1000);
			iframe.src = iframe.src;
			//document.location.reload();
			// $('#cal').delay(2500).reload();
		});
	</script>

</body>
</html>
