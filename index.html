<!DOCTYPE html>

<!--
CREDITS
- Calendar icon downloaded from https://www.iconfinder.com, used under Creative Commons.
- jCanvas from http://calebevans.me/, licensed under the MIT license.
-->

<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Schedulize Me</title>
	<meta name="description" content="Schedulize Me - an interactive class scheduler for students.">
	<meta name="author" content="">

	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="bootstrap/css/bootstrap-theme.min.css">
	<script src="bootstrap/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="css/main.css">

	<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
</head>

<body>

	<header class="header clearfix">
		<h1 class="title"><img src="icon.png" style="width:2%; height:2%; padding-bottom:10px; -webkit-filter: invert(100%);"/> Schedulize Me</h1>
	</header>
	<section class="sidebar">

		<div class="spacer"></div>

		<h2 style="padding-top:15px">Build your schedule.</h2>

		<div id="course-list"></div>
		<div id="spacer2"></div>

		<div id="newClassBlock">
			<h3 id="newClass" class="sidebaroption">ADD NEW CLASS</h3>
			<span id="hiddenNew">
				<div class="styled-select">
					<select id="selectDept" class="course-nav">
					</select>
				</div>
				<div class="styled-select">
					<select id="selectCourse" class="course-nav" selected="Course">
					</select>
				</div>
				<div class="styled-select">
					<select id="selectSection" class="course-nav">
					</select>
				</div>
				<div class="styled-select">
					<select id="selectLab" class="course-nav">
					</select>
				</div>
				<a href="#" class="btn btn-info" id="submitButton"><i class="icon-white icon-plus"></i>Add</a>
			</span>
		</div>
			
		<div id="customBlock">
			<h3 id="addCustom" class="sidebaroption">ADD CUSTOM EVENT</h3>
			<span id="hiddenCustom">
				<div class="styled-select">
					<input type="text" id="inputName" placeholder="Name" class="custom-nav"></input>
				</div>
				<div class="styled-select">
					<input type="time" id="inputBeginTime" class="custom-nav" value="00:00:00">
				</div>
				-
				<div class="styled-select">
					<input type="time" id="inputEndTime" class="custom-nav" value="00:00:00">
				</div>
				<div class="styled-select">
					<input type="text" id="inputLocation" placeholder="Location" class="custom-nav"></input>
				</div>
				<div width="50%">
					<div>
						<input type="checkbox" name="day" value="Monday" />
						<input type="checkbox" name="day" value="Tuesday" />
						<input type="checkbox" name="day" value="Wednesday" />
						<input type="checkbox" name="day" value="Thursday" />
						<input type="checkbox" name="day" value="Friday" />
						<input type="checkbox" name="day" value="Saturday" />
						<input type="checkbox" name="day" value="Sunday" />
					</div>
					<div style="letter-spacing: 2px;">
						M T W T F S S
					</div>
				</div>
				<a href="#" class="btn btn-info" id="customSubmitButton"><i class="icon-white icon-plus"></i>Add</a>
			</span>
		</div>
			
		<div id="downloadBlock">
			<h3 id="download" class="sidebaroption">DOWNLOAD SCHEDULE</h3>
			<span id="hiddenDownload">
				<a href="javascript:generatePDF()" class="button">.pdf version</a><br />
				<a href="javascript:generateCSV()">.csv version</a>
			</span>
		</div>

		<button type="button" class="btn btn-danger btn-small button-clear" onclick="clearEverything()">Clear Selections</button>
	</section>
	
	<script type="text/javascript" src="jspdf/jspdf.js"></script>
	<script type="text/javascript" src="jspdf/jspdf.plugin.standard_fonts_metrics.js"></script> 
	<script type="text/javascript" src="jspdf/jspdf.plugin.split_text_to_size.js"></script>               
	<script type="text/javascript" src="jspdf/jspdf.plugin.from_html.js"></script>
	<script type="text/javascript" src="jspdf/jspdf.plugin.addImage.js"></script>
	<script type="text/javascript" src="jspdf/libs/png_support/zlib.js"></script>
	<script type="text/javascript" src="jspdf/libs/png_support/png.js"></script>
	<script type="text/javascript" src="jspdf/jspdf.plugin.png_support.js"></script>
	<script type="text/javascript" src="jspdf/libs/FileSaver.js"></script>
	<script type="text/javascript">
		function generatePDF() {
			var image = $('canvas').getCanvasImage('png');
			var doc = new jsPDF("landscape");
			console.log(image);
			doc.addImage(image, 'PNG', 15, 20, 270, 160);
			doc.setFont('helvetica');
			doc.setFontSize(14);
			doc.text('Schedulize Me', 24, 205);
			var iconuri = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABmJLR0QA/wD/AP+gvaeTAAAEOUlEQVR42u3bQWgjVRzH8d97M91QdNEqYi11UVgWoZQ2SbtYCoJgrScPFRbBk0cvHgR1L4LiZb1YUPAi7rmIVkEQd6EnkdKkmbgtiJSKykrIiuyCutqY5v09WEuXbRJENt3MfD/HzGseffPNZDKZOB2BYrF4wjlbNNNjew99aaZXkiTZZv7eckex8yX7WtLQjVvsahy3JtbWNn7K5vy65n00US6XL/dyf/ieF+ds8ZB/XpK7Z3d3YDG782sohPB2r/dHzwMw01yHrXPMn/IAJB3vsO0u5k9/ALiNEAABgABAACAAEACypu2l4EKhcNJ7LZhpXtKDkkYk3cGS9YXrkmqSLjunCyFoud33DDcFMD09PRzC7puSe15SxFqmQkvS+TgeeG1tbe1K2wCmp/NPhOCWJN3LmqXSLyHYs9VqdeWmAKampmbNwoqkHOuUao0Q7PFqtbq6H0A+nx/xXonk7md9MqHufZQvl8t1L0lR5N5i52fKcAi75yTJnT49carVir7hhC97J4ZmesS3Wv4MOz+TIklnYsk92WXgz2Z6sdlsXtzc3Lz2f2ctFgvWaXulktzS29SyMP/4+PhQLhfPm7l3JN3XbpxzNhdLeqjTk5nphSRJlnnB9I+9F+pSsVhsSfZh+5HuYS9puNOTOee+YEn7U7PZ/LzLkAe8pIHOh6TKHyxlf9rY2LjeZcgxvgzKOAIgABAACKCHfu+w7VfmT30AbqXDxpVsz+8uZuEIcFbSIVcU7WoUtc5meX7v/UupD6BSqXwruUnntCzpt38Oe+4j7+PJUunSVhbnN9PH3seTvf5lsCS5o742jlur2/7lUwCfAkAAIAAQAAgABAACAAGAAEAAIAAQAAgABIBUins9Ybfvp7v5r/cnpH0+jgAgABAACAAEAAIAAYAAQAAgABAAuuC3gSnHbwPBWwAIAAQAAgABgABwAPcE9vl8HAFAACAAEAAIAAQAAgABgABAACAAdME9gSnHPYHgLQAEAAIAAYAAQAA4gHsC+3w+jgAgABAACAAEAAIAAYAAQAAgABAAuuCewJTjnkDwFgACAAGAAEAAIAAQAAgABAACIACWgABAACAAEACyGcBfnQaMjY3dyTL1p9nZ2eNdhjS8pHqnEYODx+ZZyv60s7PzVJch9VjSj5JOtBth5t4rFApRLpf7bHV19U+W9fY3MzMz2Gg0npbs3c4j7XtXLOZfldw5li2L3Ms+isInklosRua0zOxTXypd2pJ0nvXI3Kv//SRJtr0khWCvS3aFRcmMuvf+jf3rANVqteZc9IykBmuTeo0QbKFcLtf3A5Ck9fX1r5zzM3ufCpBOP3gfHq1Wq6v/PhAd3Fqr1eqjo6NLZuFuyU2IK4WpOeGT9EEcDzxXKlW+u+FMoN1fFAqFk95rwUzzkjsl2QhB9I0guZpkW87pQghaTpJk+7CBfwOk653RqmHn7wAAAABJRU5ErkJggg==';
			doc.addImage(iconuri, 'PNG', 17, 200.5, 5, 5);
			doc.save('SchedulizeMe.pdf');
		}
		function generateCSV() {
			var CSVstring = "";
			/*TO DO: add Location*/
			/* also these will be populated with the actual dates*/
			var currentDate = new Date("January 27, 2014");
			var endDate = new Date("May 9, 2014");
			CSVstring += "Subject, Start Date, Start Time, End Date, End Time\n";
			//$('#course-list').children().each(function(index, value) { // for each course
			jQuery.each($('#course-list').children(), function(index, value) {
				var days = 'MWF'; // change this
				for(var i = 0; i < days.length; i++) { // for each day the class is on
					while(currentDate <= endDate) { // for each week throughout the semester
						var beginTime = jQuery.data(value, 'beginTimeNum');
						var endTime = jQuery.data(value, 'endTimeNum');
						CSVstring += (this.id).replace('_', ' ') + ', ' + currentDate.toLocaleDateString() + ', ' + '10:50:00 AM' + ', ' + currentDate.toLocaleDateString() + ', ' + '11:50:00 AM';
						CSVstring += '\n'; // newline between entries
						currentDate.setDate(currentDate.getDate()+7)
						currentDate.setDate(currentDate.getDate()+7)
					}
				}
			});
			//$.post("createCSV.php", {input: CSVstring}, function(returned_data){
				//console.log(returned_data); //or do whatever you like with the variable
			//});
			console.log(CSVstring);
		}
	</script>

	
	<!-- Clear selected courses -->
	<script type="text/javascript">
		function clearEverything() {
			$('canvas').removeLayerGroup("courses").drawLayers();
			$('#course-list').empty();

			// Not going to reset the search fields
			// $('#selectCourse').css('visibility', 'hidden');
			// $('#selectSection').css('visibility', 'hidden');
			// $('#submitButton').css('visibility', 'hidden');
			// $('#selectLab').css('display', 'none');
			// $('#selectCourse').empty();
			// $('#selectSection').empty();
			// $('#selectLab').empty();
		}
	</script>

	<!-- Populate department list -->  
	<script type="text/javascript">
		$.get('http://trump6.com/schedulizeme/api/dept.php', function(data) {
			$('#selectCourse').css('visibility', 'hidden');
			$('#selectSection').css('visibility', 'hidden');
			$('#submitButton').css('visibility', 'hidden');
			$('#selectLab').css('display', 'none');
			$('#selectCourse').empty();
			$('#selectSection').empty();
			$('#selectLab').empty();
			var depts = JSON.parse(data);
			var select = document.getElementById("selectDept");
			var firstElement = document.createElement("option");
			firstElement.textContent = "Choose Department";
			firstElement.value = "";
			$(firstElement).attr('selected', 'selected');
			$(firstElement).attr('disabled', 'disabled');
			select.appendChild(firstElement);
			for(var i = 0; i < depts.length; i++) {
				var opt = depts[i];
				var el = document.createElement("option");
				// console.log(opt["dept"]);
				el.textContent = opt["dept"];
				el.value = opt["dept"];
				select.appendChild(el);
			}

		});
	</script>

	<!-- Populate course list -->
	<script type="text/javascript">
		$(selectDept).on('change', function() {
			// console.log("Department start");
			$('#selectCourse').css('visibility', 'visible');
			$('#selectSection').css('visibility', 'hidden');
			$('#submitButton').css('visibility', 'hidden');
			$('#selectLab').css('display', 'none');
			$('#selectCourse').empty();
			$('#selectSection').empty();
			$('#selectLab').empty();
			var dept = $('#selectDept').val();
			$.get('http://trump6.com/schedulizeme/api/courses.php?dept=' + dept, function(data) {
				var courses = JSON.parse(data);
				var select = document.getElementById("selectCourse");
				var firstElement = document.createElement("option");
				firstElement.textContent = "Choose Course";
				firstElement.value = "";
				$(firstElement).attr('selected', 'selected');
				$(firstElement).attr('disabled', 'disabled');
				select.appendChild(firstElement);
				for(var i = 0; i < courses.length; i++) {
					var opt = courses[i];
					var el = document.createElement("option");
					el.textContent = opt["num"] + ' - ' + opt["title"];
					el.value = opt["num"];
					select.appendChild(el);
					// console.log(el.value);
				}
			});
			// console.log("Department end");
		});
	</script>
	
	<!-- Populate section list -->
	<script type="text/javascript">
		$(selectCourse).on('change', function() {
			// console.log("Course change");
			$('#selectSection').css('visibility', 'visible');
			$('#selectLab').css('display', 'none');
			$('#submitButton').css('visibility', 'hidden');
			$('#selectSection').empty();
			$('#selectLab').empty();
			var dept = $('#selectDept').val();
			var course = $('#selectCourse').val();
			var extension = dept + '&courseNum=' + course;
			$.get('http://trump6.com/schedulizeme/api/sections.php?dept=' + extension, function(data) {
				var sections = JSON.parse(data);
				var select = document.getElementById("selectSection");
				var firstElement = document.createElement("option");
				firstElement.textContent = "Choose Section";
				firstElement.value = "";
				$(firstElement).attr('selected', 'selected');
				$(firstElement).attr('disabled', 'disabled');
				select.appendChild(firstElement);
				for (var i = 0; i < sections.length; i++) {
					var opt = sections[i];
					if (opt["credits"] != 0) {
						var el = document.createElement("option");
						el.textContent = opt["days"] + ': ' + opt["beginTime"] + ' - ' + opt["endTime"];
						el.value = opt["crn"] + opt["section"];
						select.appendChild(el);
					}
				}
			});
			// console.log("Course change done");
		});
	</script>

	<!-- Populate lab list -->
	<script type="text/javascript">
		$(selectSection).on('change', function() {
			// console.log("Section change");
			$('#selectLab').empty();
			var dept = $('#selectDept').val();
			var course = $('#selectCourse').val();
			var extension = dept + '&courseNum=' + course;
			// console.log($('#selectSection').val());
			var section = $('#selectSection').val().substring(5,6);
            $('#submitButton').css('visibility', 'hidden');

			$.get('http://trump6.com/schedulizeme/api/sections.php?dept=' + extension, function(data) {

				var sections = JSON.parse(data);
				var select = document.getElementById("selectLab");

				var firstElement = document.createElement("option");
				firstElement.textContent = "Choose Lab";
				firstElement.value = "";
				$(firstElement).attr('selected', 'selected');
				$(firstElement).attr('disabled', 'disabled');
				select.appendChild(firstElement);

				var display = false;
				for (var i = 0; i < sections.length; i++) {
					var opt = sections[i];
					if (opt["credits"] == 0 && opt["section"].substring(0,1) == section) {
						display = true;
						var el = document.createElement("option");
						el.textContent = opt["days"] + ': ' + opt["beginTime"] + ' - ' + opt["endTime"];
						el.value = opt["crn"] + opt["section"];
						select.appendChild(el);
					}
				}
				if (display) {
					$('#selectLab').css('display', 'inline-block');
				} else {
					$('#submitButton').css('visibility', 'visible');
				}
			});			
			// console.log("Section change done");
		});
	</script>

	<!-- Display submit button after lab is picked -->
	<script type="text/javascript">
		$(selectLab).on('change', function() {
			$('#submitButton').css('visibility', 'visible');
		});
	</script>

	<!-- Send crn to php to add course to schedule -->
	<script type="text/javascript">
		var func = function(data) {
			var sections = JSON.parse(data)[0];
			var dept = sections["dept"];
			var courseNum = sections["num"];
			var crn = sections["crn"];
			var dayString = sections["days"];
			var days = [];
			var daysOfWeek = "MTWRFSU";
			for (i = 0; i < dayString.length; ++i) {
				days.push(daysOfWeek.indexOf(dayString[i]));
			}
			var location = sections["location"];
			var beginTimeNum = sections["beginTimeNum"];
			var endTimeNum = sections["endTimeNum"];
			var beginTime = sections["beginTime"];
			var endTime = sections["endTime"];
			var credits = sections["credits"];

			addToCalendar(dept, courseNum, crn, days, location, beginTimeNum, endTimeNum, beginTime, endTime);
		}
		
		$(submitButton).click(function() {
			var crnSection = $('#selectSection').val().substring(0,5);
			cookieAdd(crnSection); //keep track of added classes
			var crnLab = $('#selectLab').val();
			if (crnLab != null) {
				//console.log(crnLab);
				cookieAdd(crnLab); //keep track of added classes
				crnLab = crnLab.substring(0,5);
			}
			var group = $('#selectDept').val() + "_" + $('#selectCourse').val();
			$('canvas').removeLayerGroup(group).drawLayers();

			$('#' + group).remove();
			$('canvas').removeLayerGroup(group).drawLayers();

			var dept = $('#selectDept').val();
			var course = $('#selectCourse').val();
			var content = [ $('<a href="#" class="btn btn-success picked-course">' + $('#selectDept').val() + " " + $('#selectCourse').val() + '</a>'), $('<a href="#" class="btn btn-danger"><span class="glyphicon glyphicon-remove"></span></a>') ];
			// EDITED HERE "var container = $('<div id=' + group + ' class="course-row"></div>');"
			var container = $('<div id=' + group + ' data-days=' + $('#selectSection').val() + ' class="course-row"></div>');
			$.each(content, function(i,val) {
			    container.append(val);
			});
			$('#course-list').append(container);
			var dept = $('#selectDept').val();
			var num = $('#selectCourse').val();
			var section = $('#selectSection').val();
			var lab = $('#selectLab').val();

			var beginTimeNum = 0;
			var endTimeNum = 0;
			var beginTimeNumLab = null;
			var endTimeNumLab = null;
			console.log(crnSection + ' ' + crnLab);
			$.get('http://trump6.com/schedulizeme/api/crn.php?crn=' + crnSection, function(data) {
				var sections = JSON.parse(data);
				jQuery.data(container, "beginTimeNum", sections[0]["beginTimeNum"]);
				jQuery.data(container, "endTimeNum", sections[0]["endTimeNum"]);
				// console.log(beginTimeNum);
				// console.log(endTimeNum);
			});

			if (crnLab != null) {
				$.get('http://trump6.com/schedulizeme/api/crn.php?crn=' + crnLab, function(data) {
					var sections = JSON.parse(data);
					jQuery.data(container, "beginTimeNumLab", sections[0]["beginTimeNum"]);
					jQuery.data(container, "endTimeNumLab", sections[0]["endTimeNum"]);
					// console.log(beginTimeNumLab);
					// console.log(endTimeNumLab);
				});
			}
			else {
				jQuery.data(container, "beginTimeNumLab", null);
				jQuery.data(container, "endTimeNumLab", null);
			}

			content[0].click(function() {
				var time = 150;
				setTimeout(function() {
					if (dept != $('#selectDept').val()) {
						$('#selectDept').val(dept);
						$('#selectDept').change();
					}
					setTimeout(function() {
						if (num != $('#selectCourse').val()) {
							$('#selectCourse').val(num);
							$('#selectCourse').change();
						}
						setTimeout(function() {
							if (section != $('#selectSection').val()) {
								$('#selectSection').val(section);
								$('#selectSection').change();
							}
							setTimeout(function() {
								if (lab != $('#selectLab').val()) {
									$('#selectLab').val(lab);
									$('#selectLab').change();
								}
							}, time);
						}, time);
					}, time);
				}, time);
			});
			content[1].click(function() {
				$('canvas').removeLayerGroup(group).drawLayers();
				container.remove();
			});

			$.get('http://trump6.com/schedulizeme/api/crn.php?crn=' + crnSection, func);
			if (crnLab != null) {
				$.get('http://trump6.com/schedulizeme/api/crn.php?crn=' + crnLab, func);
			}
		});
	</script>

	<!-- cookie prep -->
	<script type="text/javascript">
	var fullList=[];

	//check if cookie exists
	function readCookie(name) {
		var nameEQ = name + "=";
		var ca = document.cookie.split(','); //was split by ;
		for(var i=0;i < ca.length;i++) {
			var c = ca[i];
			while (c.charAt(0)==' ') c = c.substring(1,c.length);
			if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
		}
		return null;
	}

	var cookieInput = readCookie("CRNs");
	console.log("poop" + cookieInput);
	// what the fuck is this jack
	
	if (!!cookieInput) {
		console.log(cookieInput.length);
		for(var i = 0; i < cookieInput.length/5; i++) {
			console.log(cookieInput[i]);
			$.get('http://trump6.com/schedulizeme/api/crn.php?crn=' + cookieInput[i], func);
		}
	}

	function cookieAdd(crn) {
		fullList.push(crn);
		fullJSON = JSON.stringify(fullList);
		document.cookie="CRNs=" + fullJSON;
		console.log(document.cookie);
	}

	</script>

	<!-- CREATE CANVAS -->
	<script src='jcanvas.js'></script>
	<div class = "calendar">
		<canvas width='1450' height='860'></canvas> <!-- DON'T FORGET TO CHANGE THIS SHIT -->
		<script type="text/javascript">
			// SIZE SETTINGS
			var calWidth = 1450, calHeight = 850;
			var dayWidth = 200;
			var hourHeight = 60;
      var separator = 5;
			var timeOffset = 50;
			
			// VERTICAL LINES
			for(var i = dayWidth+timeOffset; i < dayWidth*7; i+=dayWidth) {
				$('canvas').drawLine({
					layer: true,
					strokeStyle: '#bdc3c7',
					strokeWidth: 1,
					strokeDash: [1],
					x1: i, y1: calHeight-(13*hourHeight),
					x2: i, y2: calHeight,
				});
			}
			
			// DAYS OF THE WEEK
			var weekdays = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
			var dayPos = 100;
			for(var i = 0; i < 8; i++) {
				$('canvas').drawText({
					layer: true,
					fillStyle: '#6E6E6E',
					strokeStyle: '#6E6E6E',
					strokeWidth: 0.1,
					x: dayPos+timeOffset, y: 30,
					fontSize: 26,
					fontFamily: 'Open Sans, sans-serif',
					text: weekdays[i]
				});
				dayPos+=dayWidth;
			}

			// LITTLE HOURLY TICK MARK THINGS
			for(var i = calHeight-(13*hourHeight); i < calHeight + 1; i+=hourHeight) {
				for (var j = dayWidth + timeOffset; j < dayWidth*7; j+=dayWidth) {
					$('canvas').drawLine({
						layer: true,
						strokeStyle: '#bdc3c7',
						strokeWidth: 1,
						x1: j-4, y1: i,
						x2: j+4, y2: i
					});
				}
			}
			
			// GRAY HALF-HOUR BOXES
			for(var i = calHeight-(13*hourHeight); i < calHeight; i+=hourHeight) {
				for (var j = timeOffset; j < dayWidth*7; j+=dayWidth) {
					$('canvas').drawRect({
						layer: true,
						fillStyle: '#F4F4F4',
						x: j, y: i,
						opacity: 0.5,
						fromCenter: false,
						width: dayWidth,
						height: hourHeight/2
					});
				}
			}
			
			// TIMES
			var numberColor = "#BEBEBE";
			for(var i = 0; i < 14; i++) {
				var j = i+8+' ';
				if(j > 12) {
					j-=12;
					j += ' pm';
				} else {
					j += ' am';
				}
				$('canvas').drawText({
					layer: true,
					fillStyle: numberColor,
					strokeStyle: numberColor,
					strokeWidth: 0.1,
					x: 25, y: (i*hourHeight)+(calHeight-(13*hourHeight)),
					fontSize: 12,
					fontFamily: 'Segoe UI Light, sans-serif',
					text: j
				});
			}

			function addToCalendar(dept, courseNum, crn, days, location, beginTimeNum, endTimeNum, beginTime, endTime) {

				// POSSIBLE COLORS FOR CLASSES
				var colors = ["#e8efe8", "#faf1a2", "#ffe19b", "#e9d0e5", "#8ca4d4", "#bae3f7", "#c1e4dd", "#c5d9a6", "#e74c3c"];
				var color = colors[Math.floor((Math.random() * 9))];
				
				for (i = 0; i < days.length; ++i) {
					$('canvas').drawRect({
						layer: true,
						name: crn + days[i], // unique to this specific block
						groups: [dept + "_" + courseNum, "courses"], // should be dept + num because that's unique to the group of courses when deleting an entire course
						fillStyle: color,
						x: days[i] * dayWidth + separator + timeOffset, 
						y: (calHeight-(13*hourHeight)) + (beginTimeNum-480),
						fromCenter: false,
						width: dayWidth-separator*2,
						height: endTimeNum-beginTimeNum,
						cornerRadius: 3
					});
					$('canvas').drawText({
						layer: true,
						name: crn + days[i] + 'text',
						groups: [dept + "_" + courseNum, "courses"],
						fillStyle: '#000',
						strokeWidth: 2,
						x: (days[i] * dayWidth) + (dayWidth/2) + timeOffset, 
						y: (calHeight-(13*hourHeight)) + (beginTimeNum-480) + ((endTimeNum-beginTimeNum)/2),
						fontSize: 14,
						fontFamily: 'Verdana, sans-serif',
						text: dept + ' ' + courseNum + '\n' + beginTime + ' - ' + endTime + '\n' + location
					});
				}
			}
			<!--window.open($('canvas').getCanvasImage('png'));-->
		</script>

		<script type="text/javascript">
			// Original JavaScript code by Chirp Internet: www.chirp.com.au
			// Please acknowledge use of this code by including this header.
			function getCookie(name) {
				var re = new RegExp(name + "=([^;]+)");
			  var value = re.exec(document.cookie);
				return (value != null) ? unescape(value[1]) : null;
			}

			var CRNs=[62345, 12345, 12345];
			var jsonCRNs=JSON.stringify(CRNs);
			document.cookie="CRNs=" + jsonCRNs; //can also be just +CRNs
			// console.log(document.cookie);

			// console.log(getCookie("CRNs"));

		</script>
	</div>

</body>
</html>
